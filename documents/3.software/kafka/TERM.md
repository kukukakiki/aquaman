# Kafka语术

> 主题Topic

在kafka中,发布订阅的对象是主题,主题可以通过业务、或者实例对象等来创建自己的专属主题

> 生产者Producer

向主题发布消息的客户端应用程序成为生产者,生产者通常会持续不断地向一个或多个主题发送消息

> 消费者Consumer

接收这些主题消息的客户端应用程序被称为消费者,消费者也能够接收多个主题的消息

> 客户端Clients

生产者和消费者统称为客户端,这些实力会不断向Kafka集群中的多个主题生产和消费消息

> 服务器Broker

Kafka的服务服务器端被称为Broker的服务器进程构成,即一个Kafka集群由多个Broker组成,Broker负责接收和处理客户端发来的请求,以及对消息进行持久化

> 备份机制Replication

把相同的数据拷贝到多台机器,实现高可用

> 领导者副本Leader Replica

对外提供服务,接收处理客户端消息

> 追随者副本Follower Replica

不对外提供服务,只向领导者服务发送请求,请求获取最新的数据

> 分区Partitioning

Kafka中的分区机制指的是将每个主题划分成多个分区,每个分区是一组有序的消息日志。生产者生产的每条消息只会被发送到一个分区中,也就是说如果向一个
双分区的主题发送消息,这小消息要没在分区0中,要么在分区1中。Kafka分区号从0开始,如果Topic有100个分区,那么分区号就是0到99

> 分区-副本-领导者副本-追随者副本关系

每个分区下面可以定义多个副本,其中有且仅有一个领导者副本,可以有N-1个追随者副本

> 位移Offset

每条消息由位移来表征,例如一个生产者向一个空分区写入10条消息,那么这10条消息的位移依次是0、1、2、3。。。、9

> 消费者位移Consumer Offset

用于表征消费者的消费进度,每个消费者都有自己的消费者位移

> 消费者组Consumer Group

多个消费者实例共同组成的一个组,同时消费多个分区以实现高吞吐

> 重平衡Rebalance

消费者组内某一个消费者实例挂掉后,掐消费者实例自动重新分配订阅主题分区的过程。Rabalance是Kafka消费者实现高可用的重要手段



> Kafka三层消息架构

1. 第一层是主题层,每个主题可以配置M个分区,每个分区又可以配置N个副本
2. 第二层是分区层,每个分区下面可以定义多个副本,其中有且仅有一个领导者副本,可以有N-1个追随者副本提供数据冗余
3. 第三层是消息层,分区中包含若干条消息,每条消息位移从0开始,依次递增

> Kafka图例

该图展示出了服务器端,客户端,消费者,生产者,备份,位移之间运作

[]()[![ConsumerGroup](https://github.com/kukukakiki/aquaman/blob/master/documents/3.software/kafka/images/consumer_group.JPG?raw=true)](ConsumerGroup)